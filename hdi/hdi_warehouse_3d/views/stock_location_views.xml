<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Bin List View (Standalone) -->
    <record id="view_stock_location_tree_bins" model="ir.ui.view">
        <field name="name">stock.location.tree.bins</field>
        <field name="model">stock.location</field>
        <field name="arch" type="xml">
            <list string="Warehouse Bins" create="true" delete="false">
                <field name="name"/>
                <field name="location_type" widget="badge"/>
                <field name="bin_level"/>
                <field name="bin_row"/>
                <field name="bin_col"/>
                <field name="barcode"/>
                <field name="bin_state" widget="badge"/>
                <field name="is_locked" widget="badge"/>
            </list>
        </field>
    </record>

    <!-- Bin Form View (Standalone) -->
    <record id="view_stock_location_form_bins" model="ir.ui.view">
        <field name="name">stock.location.form.bins</field>
        <field name="model">stock.location</field>
        <field name="arch" type="xml">
            <form string="Warehouse Bin">
                <sheet>
                    <div class="alert alert-info" role="alert" invisible="id">
                        <strong>üí° Creating a Bin Manually</strong><br/>
                        For best practice, create bins automatically by creating a <strong>Shelf</strong> first.<br/>
                        When you set level_count and bins_per_level on a shelf, all bins auto-generate.<br/>
                        <strong>‚ö†Ô∏è Important:</strong> BIN position must be within its parent SHELF boundaries!
                    </div>
                    
                    <div class="alert alert-danger" role="alert" invisible="not is_locked">
                        <strong>üîí LOCKED BIN</strong><br/>
                        This bin has inventory. Cannot be moved/resized/deleted.<br/>
                        <strong>‚úÖ Allowed:</strong> Block/Unblock | <strong>‚ùå Not Allowed:</strong> Move, Resize, Delete
                    </div>
                    
                    <group>
                        <group>
                            <field name="name" required="1"/>
                            <field name="parent_id" required="1" domain="[('location_type', '=', 'shelf')]" 
                                   help="Select the SHELF where this BIN will be placed"/>
                            <field name="barcode"/>
                            <field name="location_type" widget="selection" invisible="1"/>
                        </group>
                        <group>
                            <field name="bin_level" required="1" help="Level number (1=bottom, 2, 3, 4...)"/>
                            <field name="bin_row" required="1" help="Row position within shelf"/>
                            <field name="bin_col" required="1" help="Column position within shelf"/>
                            <field name="bin_state" widget="badge"/>
                        </group>
                    </group>
                    
                    <group string="Position &amp; Dimensions">
                        <group>
                            <field name="pos_x"/>
                            <field name="pos_y"/>
                        </group>
                        <group>
                            <field name="bin_width"/>
                            <field name="bin_depth"/>
                            <field name="bin_height"/>
                        </group>
                    </group>
                    
                    <group string="Capacity &amp; Status">
                        <group>
                            <field name="max_capacity"/>
                            <field name="max_weight"/>
                            <field name="is_locked" widget="badge" invisible="not is_locked"/>
                        </group>
                        <group>
                            <field name="is_blocked" widget="boolean_toggle"/>
                            <field name="block_reason" invisible="not is_blocked"/>
                            <field name="display_color_code" widget="color"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Bins Action (filtered stock.location) -->
    <record id="action_warehouse_bins" model="ir.actions.act_window">
        <field name="name">Bins</field>
        <field name="res_model">stock.location</field>
        <field name="view_mode">list,form</field>
        <field name="view_id" ref="view_stock_location_tree_bins"/>
        <field name="domain">[('location_type', '=', 'bin')]</field>
        <field name="context">{
            'default_location_type': 'bin',
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create a new Bin
            </p>
            <p>
                <strong>üí° Recommended Method:</strong> Create bins automatically by creating a <strong>Shelf</strong> first.<br/>
                When you create a Shelf with level_count and bins_per_level, all bins are auto-generated.<br/><br/>
                
                <strong>Manual Bin Creation (Advanced):</strong>
                <ol>
                    <li><strong>‚ö†Ô∏è FIRST: Select Parent SHELF</strong> - Bin position MUST be within this shelf!
                        <ul>
                            <li>Shelf boundaries: X = [pos_x, pos_x + width], Y = [pos_y, pos_y + height]</li>
                            <li>Bin must fit completely within shelf area</li>
                        </ul>
                    </li>
                    <li>Fill in required fields:
                        <ul>
                            <li><strong>Name</strong> (Location Name) - e.g., "BIN-R1-C1-L1"</li>
                            <li><strong>Bin Level</strong> - which level (1, 2, 3, 4...)</li>
                            <li><strong>Bin Row</strong> - row position within shelf</li>
                            <li><strong>Bin Column</strong> - column position within shelf</li>
                        </ul>
                    </li>
                    <li>Set Position &amp; Dimensions:
                        <ul>
                            <li><strong>pos_x, pos_y</strong> - coordinate (MUST be within shelf bounds!)</li>
                            <li><strong>bin_width, bin_depth, bin_height</strong> - physical size</li>
                        </ul>
                    </li>
                    <li>Save ‚Üí barcode auto-calculates</li>
                </ol>
                <br/>
                <strong>‚ùå Position Validation:</strong> System will reject if BIN coordinates fall outside parent SHELF area.
            </p>
        </field>
    </record>
</odoo>
