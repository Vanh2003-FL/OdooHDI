<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Server Action: Auto-optimize route when picking is confirmed -->
        <record id="action_auto_optimize_route_on_confirm" model="ir.actions.server">
            <field name="name">Auto-optimize Picking Route</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="binding_model_id" ref="stock.model_stock_picking"/>
            <field name="state">code</field>
            <field name="code">
if records.filtered(lambda p: p.use_optimized_route and p.state == 'assigned' and not p.route_id):
    for picking in records:
        picking.optimize_picking_route()
            </field>
        </record>
        
    </data>
</odoo>
