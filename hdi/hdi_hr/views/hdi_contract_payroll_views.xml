<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Salary Structure Views -->
    <record id="hdi_salary_structure_form_view" model="ir.ui.view">
        <field name="name">hdi.salary.structure.form</field>
        <field name="model">hdi.salary.structure</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Tên cấu trúc lương"/>
                        </h1>
                        <h2>
                            <field name="code" placeholder="Mã cấu trúc lương"/>
                        </h2>
                    </div>
                    <group>
                        <group>
                            <field name="grade"/>
                            <field name="level"/>
                            <field name="level_sequence"/>
                            <field name="currency_id"/>
                        </group>
                        <group>
                            <field name="is_active"/>
                            <field name="effective_date"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Khoảng lương">
                            <group>
                                <group string="Lương cơ bản">
                                    <field name="base_salary_min"/>
                                    <field name="base_salary_max"/>
                                </group>
                                <group string="Hiệu suất">
                                    <field name="performance_bonus_eligible"/>
                                    <field name="annual_bonus_percentage"/>
                                    <field name="kpi_bonus_eligible"/>
                                </group>
                            </group>
                        </page>
                        <page string="Phụ cấp">
                            <group>
                                <group>
                                    <field name="housing_allowance"/>
                                    <field name="transport_allowance"/>
                                    <field name="meal_allowance"/>
                                </group>
                                <group>
                                    <field name="phone_allowance"/>
                                    <field name="other_allowances"/>
                                </group>
                            </group>
                        </page>
                        <page string="Phúc lợi">
                            <field name="benefit_package_ids" widget="many2many_tags"/>
                        </page>
                        <page string="Mô tả">
                            <field name="description"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="hdi_salary_structure_tree_view" model="ir.ui.view">
        <field name="name">hdi.salary.structure.tree</field>
        <field name="model">hdi.salary.structure</field>
        <field name="arch" type="xml">
            <list decoration-muted="not is_active">
                <field name="name"/>
                <field name="code"/>
                <field name="grade"/>
                <field name="level"/>
                <field name="level_sequence"/>
                <field name="base_salary_min"/>
                <field name="base_salary_max"/>
                <field name="contracts_count"/>
                <field name="is_active"/>
                <field name="effective_date"/>
            </list>
        </field>
    </record>

    <!-- Benefit Package Views -->
    <record id="hdi_benefit_package_form_view" model="ir.ui.view">
        <field name="name">hdi.benefit.package.form</field>
        <field name="model">hdi.benefit.package</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Tên gói phúc lợi"/>
                        </h1>
                        <h2>
                            <field name="code" placeholder="Mã gói phúc lợi"/>
                        </h2>
                    </div>
                    <group>
                        <group>
                            <field name="package_type"/>
                            <field name="currency_id"/>
                            <field name="is_active"/>
                            <field name="effective_date"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Phúc lợi y tế">
                            <group>
                                <group string="Bảo hiểm y tế">
                                    <field name="health_insurance"/>
                                    <field name="health_insurance_coverage" invisible="health_insurance == False"/>
                                    <field name="health_insurance_amount" invisible="health_insurance == False"/>
                                </group>
                                <group string="Phúc lợi y tế bổ sung">
                                    <field name="dental_insurance"/>
                                    <field name="dental_insurance_amount" invisible="dental_insurance == False"/>
                                    <field name="life_insurance"/>
                                    <field name="life_insurance_coverage" invisible="life_insurance == False"/>
                                </group>
                            </group>
                        </page>
                        <page string="Phúc lợi tài chính">
                            <group>
                                <group string="Hưu trí &amp; Đầu tư">
                                    <field name="retirement_contribution"/>
                                    <field name="stock_options"/>
                                    <field name="stock_options_amount" invisible="stock_options == False"/>
                                </group>
                                <group string="Phúc lợi linh hoạt">
                                    <field name="flexible_benefits_budget"/>
                                </group>
                            </group>
                        </page>
                        <page string="Đãi ngộ &amp; Phụ cấp">
                            <group>
                                <group string="Phát triển chuyên nghiệp">
                                    <field name="training_budget"/>
                                    <field name="laptop_allowance"/>
                                </group>
                                <group string="Sức khỏe &amp; Lối sống">
                                    <field name="gym_membership"/>
                                    <field name="internet_allowance"/>
                                </group>
                            </group>
                        </page>
                        <page string="Vận chuyển">
                            <group>
                                <group string="Phúc lợi xe">
                                    <field name="company_car"/>
                                    <field name="fuel_allowance"/>
                                </group>
                                <group string="Đỗ xe &amp; Vận chuyển">
                                    <field name="parking_allowance"/>
                                </group>
                            </group>
                        </page>
                        <page string="Quyền lợi nghỉ phép">
                            <group>
                                <field name="additional_leave_days"/>
                                <field name="flexible_leave"/>
                            </group>
                        </page>
                        <page string="Điều kiện đủ">
                            <group>
                                <field name="minimum_salary_level"/>
                            </group>
                            <group string="Loại hợp đồng đủ điều kiện">
                                <field name="eligible_contract_types" widget="many2many_tags"/>
                            </group>
                        </page>
                        <page string="Mô tả">
                            <field name="description" widget="html"/>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="hdi_benefit_package_tree_view" model="ir.ui.view">
        <field name="name">hdi.benefit.package.tree</field>
        <field name="model">hdi.benefit.package</field>
        <field name="arch" type="xml">
            <list decoration-muted="not is_active">
                <field name="name"/>
                <field name="code"/>
                <field name="package_type"/>
                <field name="health_insurance"/>
                <field name="life_insurance"/>
                <field name="training_budget"/>
                <field name="is_active"/>
            </list>
        </field>
    </record>

    <!-- Salary Adjustment Views -->
    <record id="hdi_salary_adjustment_form_view" model="ir.ui.view">
        <field name="name">hdi.salary.adjustment.form</field>
        <field name="model">hdi.salary.adjustment</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_submit" string="Gửi phê duyệt" type="object"
                           invisible="state != 'draft'" class="oe_highlight"/>
                    <button name="action_approve" string="Phê duyệt" type="object"
                           invisible="state != 'submitted'" class="oe_highlight"/>
                    <button name="action_apply" string="Áp dụng điều chỉnh" type="object"
                           invisible="state != 'approved'" class="oe_highlight"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            Điều chỉnh lương - <field name="employee_id" readonly="1"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="contract_id"/>
                            <field name="adjustment_type"/>
                            <field name="effective_date"/>
                        </group>
                        <group>
                                <field name="requested_by_id"/>
                            <field name="approved_by_id"/>
                            <field name="approval_date"/>
                                <field name="required_approval_level"/>
                                <field name="approval_count"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Chi tiết lương">
                            <group>
                                <group string="Lương hiện tại">
                                    <field name="currency_id" invisible="1"/>
                                    <field name="previous_salary"/>
                                    <field name="previous_structure_id"/>
                                </group>
                                <group string="Lương mới">
                                    <field name="new_salary"/>
                                    <field name="new_structure_id"/>
                                    <field name="adjustment_amount"/>
                                    <field name="adjustment_percentage"/>
                                </group>
                            </group>
                        </page>
                        <page string="Lý do">
                            <group>
                                <field name="reason"/>
                            </group>
                        </page>
                        <page string="Dữ liệu hiệu suất">
                            <group>
                                <group>
                                    <field name="performance_rating"/>
                                    <field name="kpi_score"/>
                                </group>
                                <group>
                                    <field name="review_date"/>
                                </group>
                            </group>
                            <group string="Ghi chú">
                                <field name="notes" widget="html"/>
                            </group>
                        </page>
                        <page string="Lịch sử phê duyệt">
                            <field name="approval_ids">
                                <list>
                                    <field name="approver_user"/>
                                    <field name="approver_id"/>
                                    <field name="approval_date"/>
                                    <field name="comment"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="hdi_salary_adjustment_tree_view" model="ir.ui.view">
        <field name="name">hdi.salary.adjustment.tree</field>
        <field name="model">hdi.salary.adjustment</field>
        <field name="arch" type="xml">
            <list decoration-info="state=='draft'" decoration-warning="state=='submitted'"
                  decoration-success="state in ['approved', 'applied']">
                <field name="employee_id"/>
                <field name="adjustment_type"/>
                <field name="previous_salary"/>
                <field name="new_salary"/>
                <field name="adjustment_percentage"/>
                <field name="effective_date"/>
                <field name="state" widget="badge"/>
            </list>
        </field>
    </record>

    <!-- Extended HR Contract View -->
    <record id="hr_contract_form_hdi_view" model="ir.ui.view">
        <field name="name">hr.contract.form.hdi</field>
        <field name="model">hr.contract</field>
        <field name="inherit_id" ref="hr_contract.hr_contract_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='information']" position="after">
                <page string="Chi tiết hợp đồng HDI" name="hdi_details">
                    <group>
                        <group string="Loại hợp đồng &amp; Cấu trúc">
                            <field name="hdi_contract_type_id"/>
                            <field name="hdi_salary_structure_id"/>
                            <field name="contract_number"/>
                        </group>
                        <group string="Thời gian thử việc">
                            <field name="probation_start_date"/>
                            <field name="probation_end_date"/>
                            <field name="probation_passed"/>
                        </group>
                    </group>
                </page>
                <page string="Chi tiết lương" name="salary_breakdown">
                    <group>
                        <group string="Lương cơ bản">
                            <field name="base_salary"/>
                            <field name="total_compensation"/>
                        </group>
                    </group>
                    <group>
                        <group string="Phụ cấp">
                            <field name="housing_allowance"/>
                            <field name="transport_allowance"/>
                            <field name="meal_allowance"/>
                            <field name="phone_allowance"/>
                            <field name="other_allowances"/>
                        </group>
                        <group string="Hiệu suất">
                            <field name="performance_bonus_eligible"/>
                            <field name="kpi_bonus_eligible"/>
                        </group>
                    </group>
                </page>
                <page string="Phúc lợi &amp; Đánh giá" name="benefits_reviews">
                    <group string="Phúc lợi">
                        <field name="benefit_package_ids" widget="many2many_tags"/>
                    </group>
                    <group>
                        <group string="Lịch đánh giá">
                            <field name="last_review_date"/>
                            <field name="next_review_date"/>
                        </group>
                    </group>
                    <separator string="Lịch sử điều chỉnh lương"/>
                    <field name="salary_adjustment_ids">
                        <list>
                            <field name="adjustment_type"/>
                            <field name="previous_salary"/>
                            <field name="new_salary"/>
                            <field name="adjustment_percentage"/>
                            <field name="effective_date"/>
                            <field name="state"/>
                        </list>
                    </field>
                </page>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="action_create_salary_adjustment" string="Tạo điều chỉnh lương"
                       type="object" class="oe_highlight" invisible="state != 'open'"/>
                <button name="action_complete_probation" string="Hoàn thành thời gian thử việc"
                       type="object" invisible="probation_end_date == False or probation_passed == True"/>
            </xpath>
        </field>
    </record>

    <!-- Actions -->
    <record id="action_hdi_salary_structure" model="ir.actions.act_window">
        <field name="name">Cấu trúc lương</field>
        <field name="res_model">hdi.salary.structure</field>
        <field name="view_mode">list,form</field>
    </record>

    <record id="action_hdi_benefit_package" model="ir.actions.act_window">
        <field name="name">Gói phúc lợi</field>
        <field name="res_model">hdi.benefit.package</field>
        <field name="view_mode">list,form</field>
    </record>

    <record id="action_hdi_salary_adjustment" model="ir.actions.act_window">
        <field name="name">Điều chỉnh lương</field>
        <field name="res_model">hdi.salary.adjustment</field>
        <field name="view_mode">list,form</field>
    </record>

    <record id="action_hdi_contract_type" model="ir.actions.act_window">
        <field name="name">Loại hợp đồng</field>
        <field name="res_model">hdi.contract.type</field>
        <field name="view_mode">list,form</field>
    </record>
</odoo>