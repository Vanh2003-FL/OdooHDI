<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ===== WAREHOUSE LAYOUT ===== -->
    <record id="view_warehouse_layout_tree" model="ir.ui.view">
        <field name="name">hdi.warehouse.layout.tree</field>
        <field name="model">hdi.warehouse.layout</field>
        <field name="arch" type="xml">
            <tree string="Warehouse Layouts">
                <field name="name"/>
                <field name="warehouse_id"/>
                <field name="rows"/>
                <field name="columns"/>
                <field name="levels"/>
                <field name="occupied_slots"/>
                <field name="utilization_rate"/>
            </tree>
        </field>
    </record>

    <record id="view_warehouse_layout_form" model="ir.ui.view">
        <field name="name">hdi.warehouse.layout.form</field>
        <field name="model">hdi.warehouse.layout</field>
        <field name="arch" type="xml">
            <form string="Warehouse Layout">
                <header>
                    <button name="action_generate_grid" string="Generate Grid" type="object" class="oe_highlight"/>
                    <button name="action_view_grids" string="View Grid Slots" type="object"/>
                    <button name="action_view_layout" string="View Layout" type="object" class="oe_highlight"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Layout Name"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Basic Info">
                            <field name="warehouse_id" widget="many2one" required="1"/>
                            <field name="active"/>
                            <field name="description"/>
                        </group>
                        <group string="Grid Dimensions">
                            <field name="rows" required="1"/>
                            <field name="columns" required="1"/>
                            <field name="levels" required="1"/>
                        </group>
                    </group>

                    <group string="Cell Size">
                        <field name="cell_width" class="oe_inline"/>
                        <field name="cell_height" class="oe_inline"/>
                    </group>

                    <group string="Statistics">
                        <group>
                            <field name="total_slots"/>
                            <field name="occupied_slots"/>
                            <field name="empty_slots"/>
                            <field name="utilization_rate" widget="percentpie"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Zones">
                            <field name="zone_ids" mode="tree">
                                <tree editable="bottom">
                                    <field name="name"/>
                                    <field name="zone_type"/>
                                    <field name="start_row"/>
                                    <field name="end_row"/>
                                    <field name="start_column"/>
                                    <field name="end_column"/>
                                    <field name="location_count"/>
                                </tree>
                            </field>
                        </page>

                        <page string="Grid Map">
                            <div class="alert alert-info">
                                <strong>Warehouse Layout Grid Visualization</strong><br/>
                                Click on a location to view details or perform actions
                            </div>
                            <div id="warehouse_layout_grid" class="warehouse_layout_grid">
                                <!-- Grid will be rendered via JS -->
                            </div>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_warehouse_layout_kanban" model="ir.ui.view">
        <field name="name">hdi.warehouse.layout.kanban</field>
        <field name="model">hdi.warehouse.layout</field>
        <field name="arch" type="xml">
            <kanban>
                <field name="name"/>
                <field name="warehouse_id"/>
                <field name="utilization_rate"/>
                <field name="occupied_slots"/>
                <field name="total_slots"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card">
                            <div class="oe_kanban_card_header">
                                <h4><field name="name"/></h4>
                            </div>
                            <div class="oe_kanban_card_content">
                                <p><strong>Warehouse:</strong> <field name="warehouse_id"/></p>
                                <p><strong>Slots:</strong> <field name="occupied_slots"/> / <field name="total_slots"/></p>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar"
                                         t-attf-style="width: #{record.utilization_rate.value}%"
                                         t-attf-aria-valuenow="#{record.utilization_rate.value}">
                                        <t t-esc="record.utilization_rate.value"/>%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="action_warehouse_layout" model="ir.actions.act_window">
        <field name="name">Warehouse Layouts</field>
        <field name="res_model">hdi.warehouse.layout</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="search_view_id" ref=""/>
    </record>

    <!-- ===== WAREHOUSE LOCATION GRID ===== -->
    <record id="view_warehouse_location_grid_tree" model="ir.ui.view">
        <field name="name">hdi.warehouse.location.grid.tree</field>
        <field name="model">hdi.warehouse.location.grid</field>
        <field name="arch" type="xml">
            <tree string="Grid Locations" colors="red:status=='full';orange:status=='partial';green:status=='empty'">
                <field name="position_code"/>
                <field name="row"/>
                <field name="column"/>
                <field name="level"/>
                <field name="batch_id"/>
                <field name="zone_id"/>
                <field name="status"/>
                <field name="utilization_percent"/>
                <field name="is_available"/>
            </tree>
        </field>
    </record>

    <record id="view_warehouse_location_grid_form" model="ir.ui.view">
        <field name="name">hdi.warehouse.location.grid.form</field>
        <field name="model">hdi.warehouse.location.grid</field>
        <field name="arch" type="xml">
            <form string="Grid Location">
                <header>
                    <button name="action_place_batch" string="Place Batch" type="object" 
                            class="oe_highlight" attrs="{'invisible': [('batch_id', '!=', False)]}"/>
                    <button name="action_move_batch" string="Move Batch" type="object" 
                            attrs="{'invisible': [('batch_id', '=', False)]}"/>
                    <button name="action_pick_batch" string="Pick Batch" type="object" 
                            attrs="{'invisible': [('batch_id', '=', False)]}"/>
                    <button name="action_transfer_warehouse" string="Transfer Warehouse" type="object" 
                            attrs="{'invisible': [('batch_id', '=', False)]}"/>
                    <button name="action_view_batch_details" string="Batch Details" type="object" 
                            attrs="{'invisible': [('batch_id', '=', False)]}"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="position_code" class="oe_inline" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Position">
                            <field name="layout_id" readonly="1"/>
                            <field name="row" readonly="1"/>
                            <field name="column" readonly="1"/>
                            <field name="level" readonly="1"/>
                            <field name="zone_id" readonly="1"/>
                        </group>
                        <group string="Status">
                            <field name="status" widget="badge" readonly="1"/>
                            <field name="is_available" readonly="1"/>
                            <field name="is_reserved"/>
                        </group>
                    </group>

                    <group string="Current Inventory">
                        <field name="batch_id" widget="many2one"/>
                        <field name="location_id"/>
                        <field name="current_items" readonly="1"/>
                        <field name="current_weight" readonly="1"/>
                        <field name="current_volume" readonly="1"/>
                        <field name="utilization_percent" readonly="1" widget="percentpie"/>
                    </group>

                    <group string="Capacity">
                        <field name="capacity_type"/>
                        <field name="max_weight" attrs="{'invisible': [('capacity_type', '!=', 'weight')]}"/>
                        <field name="max_volume" attrs="{'invisible': [('capacity_type', '!=', 'volume')]}"/>
                        <field name="max_items" attrs="{'invisible': [('capacity_type', '!=', 'count')]}"/>
                    </group>

                    <group string="Reserved Products" attrs="{'invisible': [('is_reserved', '=', False)]}">
                        <field name="product_family"/>
                        <field name="reserved_product_ids" nolabel="1" widget="many2many_tags"/>
                    </group>

                    <group string="History">
                        <field name="last_batch_id" readonly="1"/>
                        <field name="last_change_date" readonly="1"/>
                    </group>

                    <field name="notes" nolabel="1" placeholder="Notes about this location"/>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_warehouse_location_grid" model="ir.actions.act_window">
        <field name="name">Grid Locations</field>
        <field name="res_model">hdi.warehouse.location.grid</field>
        <field name="view_mode">tree,form</field>
    </record>

    <!-- ===== WAREHOUSE ZONE ===== -->
    <record id="view_warehouse_zone_tree" model="ir.ui.view">
        <field name="name">hdi.warehouse.zone.tree</field>
        <field name="model">hdi.warehouse.zone</field>
        <field name="arch" type="xml">
            <tree string="Warehouse Zones">
                <field name="name"/>
                <field name="zone_type"/>
                <field name="layout_id"/>
                <field name="location_count"/>
            </tree>
        </field>
    </record>

    <record id="view_warehouse_zone_form" model="ir.ui.view">
        <field name="name">hdi.warehouse.zone.form</field>
        <field name="model">hdi.warehouse.zone</field>
        <field name="arch" type="xml">
            <form string="Warehouse Zone">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Zone Name"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Basic Info">
                            <field name="layout_id" required="1"/>
                            <field name="zone_type"/>
                            <field name="color" widget="color"/>
                        </group>
                        <group string="Boundaries">
                            <field name="start_row"/>
                            <field name="end_row"/>
                            <field name="start_column"/>
                            <field name="end_column"/>
                            <field name="location_count" readonly="1"/>
                        </group>
                    </group>

                    <field name="description" nolabel="1" placeholder="Description"/>
                </sheet>
            </form>
        </field>
    </record>

</odoo>
